#!/usr/bin/env bash

function main {
  local shome="$(cd -P -- "$(dirname -- "$BASH_SOURCE")/.." && pwd -P)"
  source "$shome/script/profile"

  local nm_pkg="$1"; shift
  local nm_build="${1:-$nm_pkg}"

  case "$nm_pkg" in
    sysutils/htop|htop)
      case "$(uname -s)" in
        Darwin)
          brew install htop
          ;;
        Linux)
          sudo aptitude install -y htop
          ;;
      esac
      ;;
    sysutils/runit|runit)
      case "$(uname -s)" in
        Darwin)
          brew install runit
          ;;
        Linux)
          sudo aptitude install -y runit
          ;;
      esac
      ;;
    *)
      pkg install "$nm_pkg" \
        || { pkg package "$nm_build" && pkg install "$nm_pkg"; } \
        || { pkg upgrade "$nm_build" && pkg package "$nm_build" && pkg install "$nm_pkg"; }
      ;;
  esac
}

source sub "$0" "$@"
