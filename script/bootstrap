#!/usr/bin/env bash

function bootstrap {
  local shome="$(cd -P -- "$(dirname -- "$BASH_SOURCE")/.." && pwd -P)"

  source "$shome/script/profile"

  git clone --depth 1 git@github.com:jsonn/pkgsrc "$shome/vendor/pkgsrc" || true
  git clone --depth 1 git@github.com:joyent/pkgsrc-wip "$shome/vendor/pkgsrc-wip" || true

  rsync -ia "$shome/vendor//pkgsrc-wip/runit/." "$shome/vendor/pkgsrc/sysutils/runit/"
  (cd "$shome/vendor/pkgsrc" && git apply --stat "$shome/sysutils-runit.patch")
}

bootstrap
